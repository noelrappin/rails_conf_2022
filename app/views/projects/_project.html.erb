<%= turbo_stream_from(@project) %>
<div id="<%= dom_id project %>">
  <div class="font-bold text-2xl text-center">
    <%= link_to(project.name, project) %>
  </div>

  <%= turbo_frame_tag("search_form", target: "project_body") do %>
    <%= form_with(
          url: cards_path,
          method: :get,
          html: {
            "data-controller": "autosubmit",
            "data-autosubmit-target": "form"
          }) do |f| %>
      <div class="flex justify-center content-center"
        data-controller="copy visibility"
        data-visibility-visible-value="false"
        data-action="click@window->visibility#hideOnOutsideClick">
        <div class="w-4/5 mr-4">
          <%= hidden_field_tag(:project_id, project.id) %>
          <%= text_field_tag(
                "query",
                "",
                placeholder: "Search cards", type: "search",
                id: "search_query",
                autocomplete: "off",
                autofocus: false,
                class: "w-full px-3 border border-gray-400 rounded-lg",
                "data-copy-target": "to",
                "data-action": "focus->visibility#show
                                input->visibility#hide
                                input->autosubmit#typingStarted
                                input->autosubmit#submit"
                ) %>
          <%= render("projects/recent_searches", project:) %>
        </div>
        <div class="mr-4">
          <%= f.submit(
                  "Search",
                  class: button_class,
                  "data-action": "focus->visibility#hide") %>
        </div>
        <div>
          <%= link_to(
                "Clear",
                project,
                class: button_class,
                "data-copy-text": "",
                "data-action": "click->copy#copy") %>
        </div>
      </div>
    <% end %>
  <% end %>

  <%= turbo_frame_tag("project_body") do %>
    <div>
      <%= render(
            partial: "statuses/status",
            collection: Card::STATUSES.reverse,
            as: :status,
            locals: {project: project}
          ) %>
    </div>
  <% end %>


  <% if action_name != "show" %>
    <%= link_to("Show this project", project, class: button_class) %>
    <%= link_to("Edit this project", edit_project_path(project), class: button_class) %>
    <hr class="mt-6">
  <% end %>
</div>
